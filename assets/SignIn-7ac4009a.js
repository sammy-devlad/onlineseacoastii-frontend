import{r as t,j as e,F as N,a as r,L as g,b as B,t as S,u as F,c as L,d as k,l as A,e as O}from"./index-8789f268.js";import{u as w,C as x,a as P}from"./formik.esm-7cbd9e1b.js";import{L as U,S as j}from"./index-9d78d04a.js";const E=()=>{const{laoding:n,setloading:s,setstoreDate:o,setCurrentPage:l}=t.useContext(f),i=async u=>{s(!0),B.post("/sign-in/",u).then(({data:a})=>{if(a.error)return Array.isArray(a.error)?a.error.forEach(d=>{S.error(d)}):S.error(a.error),s(!1),!1;s(!1),o(a),l(d=>d+1)}).catch(a=>{console.log(a)})},{values:c,errors:v,touched:h,handleBlur:m,handleChange:p,handleSubmit:y}=w({initialValues:{username:"",password:""},validationSchema:U,onSubmit(u,a){i(u)}});return e(N,{children:r("div",{className:"auth-card",children:[r("div",{className:"authCardHeader",children:[r("h2",{className:"font-weight-normal  ",children:["Login into",e("br",{}),"your",e("span",{children:" account"})]}),r("h4",{children:["Don`t have an account? ",e(g,{to:"/sign-up",children:"click here"})]})]}),e("div",{className:"authCardBody",children:r("form",{className:"loginFormOnne",onSubmit:y,children:[e("div",{className:"mb-3",children:e(x,{placeholder:"Account number",name:"username",handleBlur:m,handleChange:p,label:"Account Number",error:v.username,touched:h.username,type:"text",value:c.username,id:""})}),e("div",{className:"mb-3",children:e(x,{placeholder:"*****",name:"password",handleBlur:m,handleChange:p,label:"Password",error:v.password,touched:h.password,type:"password",value:c.password,id:""})}),r("div",{className:"smButton",children:[e(P,{color:"outline-primary",text:"Submit",loading:n,type:"submit"}),e("h2",{children:e(g,{to:"/forgot-password",children:"Forgot password?"})})]})]})})]})})},H=()=>{const n=F(),s=L(),{setloading:o,laoding:l,storeDate:i}=t.useContext(f);let[c]=k();const h=(c.get("next")?`${c.get("next")}`:null)||"/dashboard",{values:m,errors:p,touched:y,handleBlur:u,handleChange:a,handleSubmit:d}=w({initialValues:{security_code:""},validationSchema:j,onSubmit(b){D(b)}}),D=b=>{o(!0);const _=i.user;if(b.security_code!=_.security_pin)return S.error("Security pin is invalid"),o(!1),!1;const C=i;n(A(C)),C.user.is_superuser?s("/admin/",{replace:!1}):s(h,{replace:!1})};return t.useEffect(()=>(o(!1),()=>{}),[]),e(N,{children:r("div",{className:"auth-card",children:[r("div",{className:"authCardHeader",children:[r("h2",{className:"font-weight-normal  ",children:["Login into",e("br",{}),"your",e("span",{children:" account"})]}),r("h4",{children:["Don`t have an account? ",e(g,{to:"/sign-up",children:"click here"})]})]}),e("div",{className:"authCardBody",children:r("form",{className:"loginFormOnne",onSubmit:d,children:[e("div",{className:"mb-3",children:e(x,{placeholder:"****",name:"security_code",handleBlur:u,handleChange:a,label:"Security code",error:p.security_code,touched:y.security_code,type:"text",value:m.security_code,id:""})}),r("div",{className:"smButton",children:[e(P,{color:"outline-primary",text:"Submit",loading:l,type:"submit"}),e("h2",{children:e(g,{to:"/sign-in",children:"Reset"})})]})]})})]})})},I=()=>{const{currentPage:n}=t.useContext(f);return[e(E,{}),e(H,{})][n]},f=t.createContext(void 0),V=()=>{O("Log into your account");const[n,s]=t.useState(0),[o,l]=t.useState(!1),[i,c]=t.useState();return e(N,{children:e(f.Provider,{value:{currentPage:n,setCurrentPage:s,setstoreDate:c,storeDate:i,laoding:o,setloading:l},children:e(I,{})})})};export{f as SignInContext,V as default};
