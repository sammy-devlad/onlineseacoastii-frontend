import{n as B,r,x as D,j as e,F as P,a,q as j,c as F,s as I,t as C,p as V,e as q,v as L}from"./index-76929380.js";import{B as U}from"./BreadcrumNav-2099f685.js";import{u as k,C as S,a as w}from"./formik.esm-8f4a00e2.js";import{u as A}from"./useAxiosPrivate-58377221.js";const E=()=>{const s=B(n=>n.user.user),o=A(),[u,b]=r.useState(!1),[d,i]=r.useState(""),{setcurrentSteps:g,setformData:x}=r.useContext(y),N=D(s.username),{errors:c,handleBlur:m,handleChange:v,handleSubmit:_,values:h,touched:p,setFieldValue:t}=k({initialValues:{amount:"",account_number:"",purpose:"",beneficiary:""},validationSchema:N,onSubmit:n=>{T(n)}}),T=async n=>{x(n),g(f=>f+1)},l=({target:n})=>{t("account_number",n.value),o.post("/validate-account-numbers/",{acc_number:n.value}).then(({data:f})=>{f.valid?(t("beneficiary",f.id),i(f.name)):(t("beneficiary","Invalid"),i("invalid"))})};return e(P,{children:a("form",{onSubmit:_,children:[a("div",{className:" mb-3",id:"amount_box",children:[e(S,{handleBlur:m,handleChange:v,label:"Amount",name:"amount",type:"number",value:h.amount,touched:p.amount,error:c.amount,id:"",placeholder:""}),e("i",{className:"fa-solid fa-dollar dollarSign"})]}),a("div",{className:" mb-3",children:[e(S,{handleBlur:m,handleChange:l,label:"Account Number",name:"account_number",type:"number",value:h.account_number,touched:p.account_number,error:c.account_number,id:"",placeholder:""}),a("p",{className:"text-muted mt-1",children:["benneficiary : Â ",c.beneficiary?e("span",{className:"text-danger ",children:c.beneficiary}):e("span",{className:"text-warning ",children:d})]})]}),e("div",{className:" mb-3",children:e(S,{handleBlur:m,handleChange:v,label:"Purpose of Transfer",name:"purpose",type:"text",value:h.purpose,touched:p.purpose,placeholder:"purpose of transfer",error:c.purpose,id:""})}),e("div",{className:" mb-3",children:e("div",{className:"d-grid gap-2",children:e(w,{color:"outline-primary",text:"Submit",loading:u,type:"submit"})})})]})})},O=()=>{const s=B(t=>t.user.user),{formData:o}=r.useContext(y),u=j();let b=o;const[d,i]=r.useState(!1),g=A(),x=F(),{errors:N,handleBlur:c,handleChange:m,handleSubmit:v,values:_,touched:h}=k({initialValues:{security_code:""},validationSchema:I,onSubmit:t=>{p(b,t)}}),p=async(t,T)=>{if(s.security_pin===T.security_code){i(!0);try{const{data:l}=await g.post("/transfer-same/",t);l.error?C.error(l.msg):(u(V(l.tx.sender)),C.info("Transaction created")),x("/transactions-log",{replace:!0})}catch{}return!0}else return C.error("Invalid security pin"),!1};return e(P,{children:a("form",{onSubmit:v,children:[a("div",{className:" mb-3",id:"amount_box",children:[e(S,{handleBlur:c,handleChange:m,label:"Security Pin",name:"security_code",type:"text",value:_.security_code,touched:h.security_code,error:N.security_code,id:"",placeholder:""}),e("i",{className:"fa-solid fa-lock dollarSign"})]}),e("div",{className:" mb-3",children:e("div",{className:"d-grid gap-2",children:e(w,{color:"outline-primary",text:"Submit",loading:d,type:"submit"})})})]})})},R=()=>{const{currentSteps:s}=r.useContext(y);return[e(E,{}),e(O,{})][s]},y=r.createContext(void 0),H=()=>{q("Transfer to onlineseacoat bank");const[s,o]=r.useState(0),[u,b]=r.useState(),d=B(i=>i.user.user);return e(P,{children:e("div",{className:"container",children:a("div",{className:"row justify-content-center align-item-center",children:[e(U,{pagenavTitle:"Transfer",currentPage:"transfer"}),e("div",{className:"mt-4"}),e("div",{className:"col-lg-4",children:a("div",{className:"amountBox",children:[e("h4",{children:"available balance"}),a("h2",{children:["$",e("span",{children:L(d.balance)})]})]})}),e("div",{className:"col-lg-8",children:a("div",{className:"transferCard",children:[e("p",{children:"Transfer to the same bank"}),e(y.Provider,{value:{currentSteps:s,setcurrentSteps:o,formData:u,setformData:b},children:e(R,{})}),e("small",{style:{color:"red"},children:"Warning: if you have insufficient funds in your account to cover the transactions, your account is at risk of going into overdraft."})]})})]})})})};export{y as TxtSameContext,H as default};
