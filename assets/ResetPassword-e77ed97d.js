import{e as C,c as S,r as c,d as k,b as f,t as o,j as e,F as y,a as t,L as x}from"./index-3598420a.js";import{u as B,C as g,a as E}from"./formik.esm-30aa03e9.js";import{c as U}from"./index-89808e30.js";const O=()=>{C("Reset password");const d=S(),[v,n]=c.useState(!1),[N,b]=c.useState(),[l]=k(),{values:u,errors:m,touched:w,handleBlur:h,handleChange:p,handleSubmit:P}=B({initialValues:{newpassword:"",confirmnewpassword:""},validationSchema:U,onSubmit(a,r){R(a)}}),R=async a=>{n(!0);try{const r=N,{data:s}=await f.post("/reset-password/",{...a,...r});if(s.error)return o.error(s.msg),n(!1),!1;o.info("Password Reset You can now login"),d("/sign-in")}catch(r){let s=r;console.log(s),o.error(s.message)}};return c.useEffect(()=>{const a=l.get("token"),r=l.get("uid"),s=setTimeout(()=>{n(!0),f.get(`/reset-password/?uid=${r}&token=${a}`).then(({data:i})=>{i.error&&(o.error("Link is invalid"),d("/forgot-password")),n(!1),b(i.user)}).catch(i=>{console.log(i),o.error("UNKNOWN ERROR OCCURRED"),d("/forgot-password")})},1e3);return()=>clearTimeout(s)},[]),e(y,{children:t("div",{className:"auth-card",children:[t("div",{className:"authCardHeader",children:[t("h2",{className:"font-weight-normal  ",children:["Reset",e("br",{}),"your",e("span",{children:" Password"})]}),t("h4",{children:["Don`t have an account? ",e(x,{to:"/sign-up",children:"click here"})]})]}),e("div",{className:"authCardBody",children:t("form",{onSubmit:P,children:[e("div",{className:"mb-3",children:e(g,{placeholder:"*****",name:"newpassword",handleBlur:h,handleChange:p,label:"New Password",error:m.newpassword,touched:w.newpassword,type:"password",value:u.newpassword,id:""})}),e("div",{className:"mb-3",children:e(g,{placeholder:"*****",name:"confirmnewpassword",handleBlur:h,handleChange:p,label:"Confirm New Password",error:m.confirmnewpassword,touched:w.confirmnewpassword,type:"password",value:u.confirmnewpassword,id:""})}),e("div",{className:"smButton reg",children:e(E,{color:"outline-primary",text:"Submit",loading:v,type:"submit"})})]})})]})})};export{O as default};
